<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Green Guard</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="/static/css/profile.css" />
</head>

<body>
  <!-- Loader -->
  <div id="loader" class="loader-container">
    <div class="spinner"></div>
  </div>

  <!-- Profile Content -->
  <div class="main-content" style="display: flex;">
    <div class="profile-container">
      <!-- Profile Section -->
      <div class="profile-section">
        <!-- Header Section -->
        <div class="profile-header">
          <div class="header-content">
            <h2>Your Profile</h2>
            <div class="underline"></div>
          </div>
        </div>

        <!-- Profile Card -->
        <div class="profile-card">
          <div class="profile-grid">
            <div class="field">
              <i class="fas fa-user"></i>
              <div class="field-content">
                <label>Full Name</label>
                <span id="profile-name">Loading...</span>
              </div>
            </div>
            <div class="field">
              <i class="fas fa-envelope"></i>
              <div class="field-content">
                <label>Email Address</label>
                <span id="profile-email">Loading...</span>
              </div>
            </div>
            <div class="field">
              <i class="fas fa-phone"></i>
              <div class="field-content">
                <label>Phone Number</label>
                <span id="profile-phone">Loading...</span>
              </div>
            </div>
            <div class="field">
              <i class="fas fa-map-marker-alt"></i>
              <div class="field-content">
                <label>State</label>
                <span id="profile-state">Loading...</span>
              </div>
            </div>
            <div class="field">
              <i class="fas fa-globe-americas"></i>
              <div class="field-content">
                <label>District</label>
                <span id="profile-district">Loading...</span>
              </div>
            </div>
            <div class="field">
              <i class="fas fa-seedling"></i>
              <div class="field-content">
                <label>Farmer Type</label>
                <span id="profile-farmerType">Loading...</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="button-row">
          <button onclick="location.href='edit_profile.html'" class="edit-btn">
            <i class="fas fa-edit"></i>
            <span>Edit Profile</span>
          </button>
          <button onclick="logout()" class="logout-btn">
            <i class="fas fa-sign-out-alt"></i>
            <span>Logout</span>
          </button>
        </div>
      </div>

      <!-- Features Section -->
      <div class="features-section">
        <div class="features-content">
          <h3>Coming Soon!</h3>
          <p>Exciting new features are being developed to enhance your farming experience.</p>
          
          <div class="upcoming-features">
            <div class="feature-item">
              <span>ðŸš€</span>
              <span>Advanced AI Crop Analysis</span>
            </div>
            <div class="feature-item">
              <span>ðŸ“ˆ</span>
              <span>Real-time Weather Integration</span>
            </div>
            <div class="feature-item">
              <span>ðŸ¤–</span>
              <span>Smart Irrigation Control</span>
            </div>
            <div class="feature-item">
              <span>ðŸ“±</span>
              <span>Mobile App Launch</span>
            </div>
            <div class="feature-item">
              <span>ðŸ’°</span>
              <span>Advanced Market Predictions</span>
            </div>
            <div class="feature-item">
              <span>ðŸŒ±</span>
              <span>Carbon Footprint Tracking</span>
            </div>
          </div>
          
          <div class="features-link">
            <a href="javascript:void(0)" onclick="goToDashboard()" class="home-btn">
              <i class="fas fa-home"></i>
              <span>Home</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.12.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.1/firebase-firestore-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAhkb7NJbm_iaYrEyzS_G9quAbk3rIHkLM",
      authDomain: "greenguard-408ed.firebaseapp.com",
      projectId: "greenguard-408ed"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    firebase.auth().onAuthStateChanged(async (user) => {
      const loader = document.getElementById("loader");
      const mainContent = document.querySelector(".main-content");

      // Set a timeout to hide loader after 5 seconds regardless
      setTimeout(() => {
        if (loader) {
          loader.style.display = "none";
        }
        if (mainContent) {
          mainContent.style.display = "flex";
        }
      }, 5000);

      if (user) {
        const uid = user.uid;
        try {
          const doc = await db.collection("users").doc(uid).get();
          if (doc.exists) {
            const data = doc.data();
            
            // Animate the profile data loading
            setTimeout(() => {
              document.getElementById("profile-name").innerText = data.name || "Not provided";
              document.getElementById("profile-name").style.opacity = "1";
            }, 200);
            
            setTimeout(() => {
              document.getElementById("profile-email").innerText = data.email || "Not provided";
              document.getElementById("profile-email").style.opacity = "1";
            }, 400);
            
            setTimeout(() => {
              document.getElementById("profile-phone").innerText = data.phone || "Not provided";
              document.getElementById("profile-phone").style.opacity = "1";
            }, 600);
            
            setTimeout(() => {
              document.getElementById("profile-state").innerText = data.state || "Not provided";
              document.getElementById("profile-state").style.opacity = "1";
            }, 800);
            
            setTimeout(() => {
              document.getElementById("profile-district").innerText = data.district || "Not provided";
              document.getElementById("profile-district").style.opacity = "1";
            }, 1000);
            
            setTimeout(() => {
              document.getElementById("profile-farmerType").innerText = data.farmerType || "Not provided";
              document.getElementById("profile-farmerType").style.opacity = "1";
            }, 1200);
            
          } else {
            // Handle case when no user data is found
            const fields = ["profile-name", "profile-email", "profile-phone", "profile-state", "profile-district", "profile-farmerType"];
            fields.forEach(fieldId => {
              document.getElementById(fieldId).innerText = "No data available";
              document.getElementById(fieldId).style.opacity = "1";
            });
          }
        } catch (error) {
          console.error("Error fetching profile:", error);
          // Handle error state
          const fields = ["profile-name", "profile-email", "profile-phone", "profile-state", "profile-district", "profile-farmerType"];
          fields.forEach(fieldId => {
            document.getElementById(fieldId).innerText = "Error loading data";
            document.getElementById(fieldId).style.opacity = "1";
          });
        } finally {
          if (loader) {
            loader.style.display = "none";
          }
          if (mainContent) {
            mainContent.style.display = "flex";
          }
        }
      } else {
        // Hide loader immediately if no user
        if (loader) {
          loader.style.display = "none";
        }
        if (mainContent) {
          mainContent.style.display = "flex";
        }
        window.location.href = "login.html";
      }
    });

    function logout() {
      firebase.auth().signOut().then(() => {
        window.location.href = "login.html";
      });
    }

    function goToDashboard() {
      try {
        // Try to navigate to dashboard
        window.location.href = "/DAS";
      } catch (error) {
        console.error("Navigation error:", error);
        // Fallback navigation methods
        try {
          window.location.assign("/DAS");
        } catch (e) {
          // Last resort - try to open in new tab
          window.open("/DAS", "_self");
        }
      }
    }
  </script>

  <!-- Footer -->
  <footer class="footer">
      <div class="footer-container">
          <div class="footer-content">
              <!-- Company Info -->
              <div class="footer-section">
                  <div class="footer-logo">
                      <img src="/static/image/greenguard_logo.png" alt="Green Guard Logo" />
                      <h3>Green Guard</h3>
                  </div>
                  <p class="footer-description">
                      Empowering Indian farmers with modern technology and innovative agricultural solutions for sustainable farming practices.
                  </p>
                  <div class="social-links">
                      <a href="https://facebook.com/greenguardindia" class="social-link" title="Facebook" target="_blank">
                          <i class="fab fa-facebook-f"></i>
                      </a>
                      <a href="https://twitter.com/greenguardindia" class="social-link" title="Twitter" target="_blank">
                          <i class="fab fa-twitter"></i>
                      </a>
                      <a href="https://linkedin.com/company/greenguard-india" class="social-link" title="LinkedIn" target="_blank">
                          <i class="fab fa-linkedin-in"></i>
                      </a>
                      <a href="https://instagram.com/greenguardindia" class="social-link" title="Instagram" target="_blank">
                          <i class="fab fa-instagram"></i>
                      </a>
                      <a href="https://youtube.com/@greenguardindia" class="social-link" title="YouTube" target="_blank">
                          <i class="fab fa-youtube"></i>
                      </a>
                  </div>
              </div>

              <!-- Quick Links -->
              <div class="footer-section">
                  <h4 class="footer-title">Quick Links</h4>
                  <ul class="footer-links">
                      <li><a href="/DAS">Dashboard</a></li>
                      <li><a href="disease.html">AI Disease Detection</a></li>
                      <li><a href="about.html">About Us</a></li>
                      <li><a href="team.html">Our Team</a></li>
                      <li><a href="crop_advice.html">Crop Advice</a></li>
                        <li><a href="market.html">Market Info</a></li>
                        <li><a href="schemes.html">Government Schemes</a></li>
                        <li><a href="profile.html">Profile</a></li>
                  </ul>
              </div>

              <!-- Services -->
              <div class="footer-section">
                  <h4 class="footer-title">Our Services</h4>
                  <ul class="footer-links">
                        <li><a href="/DAS">AI Disease Detection</a></li>
                        <li><a href="/DAS">Weather Forecast</a></li>
                        <li><a href="market.html">Market Analysis</a></li>
                      <li><a href="crop_advice.html">Crop Recommendations</a></li>
                      <li><a href="schemes.html">Government Schemes</a></li>
                      <li><a href="market.html">Seed & Equipment Market</a></li>
                      <li><a href="about.html">Support & Help</a></li>
                  </ul>
              </div>

              <!-- Contact Info -->
              <div class="footer-section">
                  <h4 class="footer-title">Contact Us</h4>
                  <div class="contact-info">
                      <div class="contact-item">
                          <i class="fas fa-envelope"></i>
                          <span>contact@greenguard.in</span>
                      </div>
                      <div class="contact-item">
                          <i class="fas fa-phone"></i>
                          <span>+91 9090909090</span>
                      </div>
                      <div class="contact-item">
                          <i class="fas fa-map-marker-alt"></i>
                          <span>Kolhapur, Maharashtra, India</span>
                      </div>
                      <div class="contact-item">
                          <i class="fas fa-clock"></i>
                          <span>Mon - Fri: 9:00 AM - 6:00 PM</span>
                      </div>
                      <div class="contact-item">
                          <i class="fas fa-globe"></i>
                          <span>www.greenguard.in</span>
                      </div>
                  </div>
              </div>
          </div>

          <!-- Footer Bottom -->
          <div class="footer-bottom">
              <div class="footer-bottom-content">
                  <div class="copyright">
                      <p>&copy; 2025 Green Guard. All rights reserved.</p>
                  </div>
                  <div class="footer-bottom-links">
                      <a href="privacy-policy.html">Privacy Policy</a>
                      <a href="terms-of-service.html">Terms of Service</a>
                      <a href="cookie-policy.html">Cookie Policy</a>
                      <a href="contact.html">Contact</a>
                  </div>
              </div>
          </div>
      </div>
  </footer>
</body>

</html>
